# 2026-02-02：CLI 命令速查（以独立 CLI 工程为主）

## 入口

推荐入口（内部调用现存 Tools）：

- 已安装 dotnet tool：`windows-agent help`
- 从源码运行：`dotnet run --project src/Windows.Agent.Cli/Windows.Agent.Cli.csproj -- help`

## 通用参数

- `--pretty`：JSON 美化输出

## 输出说明（独立 CLI 工程）

- CLI 默认输出 JSON 到 stdout，结构固定为：
  - `success`：是否成功（目前代表 CLI 调度成功；工具内部失败会体现在 `result.raw/parsed` 内）
  - `tool`：调用的 Tool/方法标识
  - `result.raw`：工具原始输出（字符串）
  - `result.parsed`：若 `raw` 是 JSON，会尝试解析并附带该字段

## Desktop

- `desktop state [--vision true|false]`
- `desktop click --x <int> --y <int> [--button left|right|middle] [--clicks <int>]`
- `desktop type --x <int> --y <int> --text <string> [--clear] [--enter] [--interpretSpecialCharacters]`
- `desktop screenshot`
- `desktop openbrowser [--url <string>] [--search <string>]`
- `desktop scrape --url <string>`
- `desktop powershell --command <string>`
- `desktop launch --name <app>`
- `desktop switch --name <app>`
- `desktop windowinfo --name <app>`
- `desktop resize --name <app> [--width <int>] [--height <int>] [--x <int>] [--y <int>]`
- `desktop move --x <int> --y <int>`
- `desktop drag --startx <int> --starty <int> --endx <int> --endy <int>`
- `desktop scroll [--x <int> --y <int>] [--type vertical|horizontal] [--direction up|down|left|right] [--wheel <int>]`
- `desktop clipboard --mode copy|paste [--text <string>]`
- `desktop wait --seconds <int>`
- `desktop key --key <string>`
- `desktop shortcut --keys <string>`（示例：`ctrl+shift+esc`）
- `desktop ui-find --type text|className|automationId --value <string>`
- `desktop ui-props --x <int> --y <int>`
- `desktop ui-wait --type text|className|automationId --value <string> [--timeoutMs <int>]`

## FileSystem

- `fs read --path <string>`
- `fs write --path <string> --content <string> [--append]`
- `fs create --path <string> --content <string>`
- `fs delete --path <string>`
- `fs copy --source <string> --destination <string> [--overwrite]`
- `fs move --source <string> --destination <string> [--overwrite]`
- `fs list --path <string> [--files true|false] [--dirs true|false] [--recursive]`
- `fs mkdir --path <string> [--parents]`
- `fs rmdir --path <string> [--recursive]`
- `fs info --path <string>`
- `fs search-name --directory <string> --pattern <string> [--recursive]`
- `fs search-ext --directory <string> --ext <string> [--recursive]`

## OCR

- `ocr screen`
- `ocr region --x <int> --y <int> --width <int> --height <int>`
- `ocr find --text <string>`
- `ocr coords --text <string>`
- `ocr file --path <string>`

## SystemControl

- `sys volume [--inc|--dec] [--percent <int>] [--mute true|false]`
- `sys brightness [--inc|--dec] [--percent <int>]`
- `sys resolution --type high|medium|low`
